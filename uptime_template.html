<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SaaS Accounts Application Uptime Report</title>

  <style>
    body {
      margin: 0;
      padding: 0;
      background: #f4f6f8;
      font-family: Segoe UI, Arial, sans-serif;
      font-size: 13px;
      color: #1f2937;
    }

    .container { width: 100%; background: #ffffff; }
    .section { padding: 12px 18px; }

    .header {
      background: #e01e7e;
      color: #ffffff;
      padding: 16px 20px;
    }

    .header-title { font-size: 18px; font-weight: 600; }
    .header-subtitle { font-size: 13px; opacity: 0.9; }

    .kpi {
      background: #f9fafb;
      border-radius: 8px;
      padding: 10px;
    }

    .kpi-value { font-size: 17px; font-weight: 700; }

    .green { color: #16a34a; }
    .red { color: #dc2626; }
    .orange { color: #f59e0b; }
    .purple { color: #7c3aed; }

    .section-header {
      margin: 14px 0 8px;
      padding-left: 8px;
      border-left: 4px solid #e01e7e;
      font-weight: 600;
    }

    .uptime-table {
      width: 100%;
      border-collapse: collapse;
    }

    .uptime-table th,
    .uptime-table td {
      border: 1px solid #e5e7eb;
      padding: 7px;
      font-size: 12px;
    }

    .uptime-table th {
      background: #e01e7e;
      color: #ffffff;
    }

    .footer {
      border-top: 1px solid #e5e7eb;
      padding: 14px 18px;
      font-size: 12px;
    }
  </style>
</head>

<body>
<table width="100%" cellpadding="0" cellspacing="0">
<tr>
<td align="center">

<table class="container" width="100%">

<!-- HEADER -->
<tr>
<td class="header">
  <div class="header-title">SaaS Accounts Application Uptime Report</div>
  <div class="header-subtitle">Weekly Application Availability Summary</div>
</td>
</tr>

<!-- KPI -->
<tr>
<td class="section">
<table width="100%" cellspacing="8">
<tr>

  <!-- KPI 1 -->
  <td class="kpi" title="Weekly Uptime Avg of all accounts">
    <div class="kpi-value green">‚úî {{ overall_uptime }}</div>
    Overall Uptime Avg
  </td>

  <!-- KPI 2 -->
  <td class="kpi" title="Total outages in weekly">
    <div class="kpi-value red">‚ö† {{ outage_count }}</div>
    Outages
  </td>

  <!-- KPI 3 -->
  <td class="kpi" title="{{ major_incident.hover }}">
    <div class="kpi-value purple">üö© {{ major_incident.account or 'N/A' }}</div>
    Most Affected Account
  </td>

  <!-- KPI 4 -->
  <td class="kpi" title="Total outage downtime in minutes">
    <div class="kpi-value orange">‚è± {{ total_downtime }} mins</div>
    Outage Downtime
  </td>

</tr>
</table>
</td>
</tr>

<!-- WEEKLY GRAPH -->
<tr>
<td class="section">
<div class="section-header">Weekly Uptime by Account</div>

<table width="100%">
<tr>

<td width="70%" valign="top">
  <img src="data:image/png;base64,{{ weekly_bar }}"
       width="100%"
       style="max-width:700px;display:block;">
</td>

<td width="30%" valign="top">

<!-- OUTAGES BOARD -->
<div style="
  background:#ffffff;
  border-left:4px solid #dc2626;
  padding:14px 16px;
  border-radius:6px;
  box-shadow:0 4px 12px rgba(0,0,0,.08);
">
  <div style="font-size:14px;font-weight:700;color:#111827;margin-bottom:6px;">
    Outages
  </div>
  <div style="height:1px;background:#e5e7eb;margin-bottom:8px;"></div>

  {% if weekly_outages %}
    {% for o in weekly_outages %}
      <div style="display:flex;justify-content:space-between;font-size:13px;margin-bottom:6px;">
        <span>{{ o.account }}</span>
        <span style="font-weight:600;color:#dc2626;">{{ o.mins }} mins</span>
      </div>
    {% endfor %}
  {% else %}
    <div style="color:#16a34a;font-weight:600;font-size:13px;">
      No outages reported
    </div>
  {% endif %}
</div>

</td>
</tr>
</table>
</td>
</tr>

<!-- WEEKLY TABLE -->
<tr>
<td class="section">
  <div class="section-header">{{ weekly_title }}</div>
  {{ weekly_table | safe }}
</td>
</tr>

<!-- FOOTER -->
<tr>
<td class="footer">
  For any concern contact
  <a href="mailto:incident@businessnext.com">incident@businessnext.com</a><br><br>

  Best Regards,<br>
  Atin Gambhir | Manager ‚Äì ITSM (CDG)<br>

  <img src="cid:businessnext_logo" width="90" style="margin-top:6px"><br>
  www.businessnext.com<br>

  <b style="color:#e01e7e;">#UpForTomorrow</b>
</td>
</tr>

</table>
</td>
</tr>
</table>
</body>
</html>
