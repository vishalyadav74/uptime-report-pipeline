<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>SaaS Accounts Application Uptime Report</title>

  <style>
    body{
      margin:0;
      padding:0;
      background:#f4f6f8;
      font-family:Segoe UI,Arial,sans-serif;
      font-size:13px;
      color:#1f2937;
    }

    .container{ width:100%; background:#ffffff; }
    .section{ padding:12px 18px; }

    .header{
      background:#e01e7e;
      color:#fff;
      padding:16px 20px;
    }

    .header-title{ font-size:18px; font-weight:600; }
    .header-subtitle{ font-size:13px; opacity:.9; }

    .kpi{
      background:#f9fafb;
      border-radius:8px;
      padding:10px;
    }

    .kpi-value{
      font-size:17px;
      font-weight:700;
    }

    .green{ color:#16a34a; }
    .red{ color:#dc2626; }
    .orange{ color:#f59e0b; }

    .downtime-card{
      background:#ffffff;
      border:1px solid #e5e7eb;
      border-radius:14px;
      padding:14px;
    }

    .downtime-title{
      font-weight:600;
      font-size:14px;
      margin-bottom:10px;
    }

    .account-row{
      margin-top:6px;
      font-size:12.5px;
    }

    .dot{
      display:inline-block;
      width:8px;
      height:8px;
      border-radius:50%;
      margin-right:6px;
    }

    .dot-1{ background:#ef4444; }
    .dot-2{ background:#f59e0b; }
    .dot-3{ background:#3b82f6; }
    .dot-4{ background:#10b981; }
    .dot-5{ background:#9ca3af; }

    .section-header{
      margin:12px 0 6px;
      padding-left:8px;
      border-left:4px solid #e01e7e;
      font-weight:600;
    }

    .uptime-table{
      width:100%;
      border-collapse:collapse;
    }

    .uptime-table th,
    .uptime-table td{
      border:1px solid #e5e7eb;
      padding:7px;
      font-size:12px;
    }

    .uptime-table th{
      background:#e01e7e;
      color:#fff;
    }

    .tick-circle{
      display:inline-block;
      width:15px;
      height:15px;
      border-radius:50%;
      background:#22c55e;
      color:#fff;
      font-size:11px;
      line-height:15px;
      text-align:center;
      margin-right:6px;
    }

    .footer{
      border-top:1px solid #e5e7eb;
      padding:14px 18px;
      font-size:12px;
    }
  </style>
</head>

<body>
<table width="100%">
<tr><td align="center">
<table class="container">

<tr>
  <td class="header">
    <div class="header-title">
      SaaS Accounts Application Uptime Report
    </div>
    <div class="header-subtitle">
      Weekly Application Availability Summary
    </div>
  </td>
</tr>

<tr>
  <td class="section">
    <table width="100%" cellspacing="8">
      <tr>
        <td class="kpi">
          <div class="kpi-value green">✔ {{ overall_uptime }}</div>
          Overall Uptime
        </td>
        <td class="kpi">
          <div class="kpi-value red">⚠ {{ outage_count }}</div>
          Outages
        </td>
        <td class="kpi">
          <div class="kpi-value orange">⏱ {{ total_downtime }} mins</div>
          Downtime
        </td>
      </tr>
    </table>
  </td>
</tr>

<tr>
  <td class="section">
    <div class="downtime-card">
      <div class="downtime-title">Weekly Uptime by Account</div>
      <img src="cid:downtime_chart"
           width="280"
           style="display:block;margin:auto;">

      {% for b in breakdown %}
      <div class="account-row">
        <span class="dot dot-{{ (loop.index0 % 5) + 1 }}"></span>
        {{ b.account }} — <b>{{ b.percent }}</b>
      </div>
      {% endfor %}
    </div>
  </td>
</tr>

<tr>
  <td class="section">
    <div class="section-header">{{ weekly_title }}</div>
    {{ weekly_table | safe }}
  </td>
</tr>

<tr>
  <td class="footer">
    For any concern contact
    <a href="mailto:incident@businessnext.com">
      incident@businessnext.com
    </a><br><br>
    Best Regards,<br>
    Businessnext | ITSM Team
  </td>
</tr>

</table>
</td></tr>
</table>
</body>
</html>
